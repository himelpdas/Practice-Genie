{{extend 'layout.html'}}
<div class="panel panel-default">
    <div class="panel-heading">
        <h3 class="panel-title pull-left display-3"><span
                class="glyphicon glyphicon-paste"></span> {{=request.function.capitalize()}} {{=request.controller.capitalize()}}
        </h3>
        <button type="button" class="btn btn-primary pull-right btn-sm" data-toggle="modal"
                data-target="#add_referral_modal"><span class="glyphicon glyphicon-plus"></span>
            Add Referral
        </button>
        <div class="clearfix"></div>
    </div>
    <div class="panel-body" style="overflow-x: auto;"> {{# otherwise it will overflow beyond panel-body when resized}}
        <table class="table table-striped table-hover table-bordered table-condensed">
            <tr>
                <th><span class="glyphicon glyphicon-check"></span></th>
                <th><span class="glyphicon glyphicon-flag"></span></th>
                <th>Order Date</th>
                <th>Patient Name</th>
                <th>Date of Birth</th>
                <th>Ordering Provider</th>
                <th>Referral Destination</th>
                <th>Appointment Date</th>
                <th>Options</th>
            </tr>
        {{for i, row in enumerate(rows):}}
            <tr>
                <td><input type="checkbox"></td>
                <td>
                {{if row.referral.urgent:}}
                    <span class="glyphicon glyphicon-exclamation-sign text-danger" title="Urgent" data-toggle="tooltip"
                          data-placement="top"></span></td>
            {{pass}}
                <td>{{=row.referral.order_date}}</td>
                <td>{{=row.patient.last_name}}, {{=row.patient.first_name}}</td>
                <td>{{=row.patient.date_of_birth}}</td>
                <td>{{=row.provider.first_name}} {{=row.provider.last_name}} {{=row.provider.title}}</td>
                <td>{{=row.site.name}}</td>
                <td>{{=row.referral.appointment_date}}</td>
                <td>
                    <div class="btn-group" role="group"
                         style="display: flex; justify-content: center;"> {{#http://stackoverflow.com/questions/10706177/bootstrap-btn-group-mis-aligned}}
                        <button type="button" class="btn btn-secondary btn-sm"><span
                                class="glyphicon glyphicon-trash" title="Trash"
                                data-toggle="tooltip"
                                data-placement="top"></span></button>
                        <button type="button" class="btn btn-secondary btn-sm"><span
                                class="glyphicon glyphicon-edit" title="Edit"
                                data-toggle="tooltip"
                                data-placement="top"></span></button>
                        <button type="button" class="btn btn-secondary btn-sm"><span
                                class="glyphicon glyphicon-duplicate" title="Notes"
                                data-toggle="tooltip"
                                data-placement="top"></span></button>
                    </div>
                </td>
            </tr>
        {{pass}}
        </table>
    </div>
    <div class="panel-footer">
        <button type="button" class="btn btn-info btn-sm pull-left"><span
                class="glyphicon glyphicon glyphicon-share-alt"></span> Send Reminders
        </button>
        <div class="btn-group pull-right"
             role="group">  {{# The .btn classes are designed to be used with the <button> element. However, you can also use these classes on <a> or <input> elements. When using button classes on <a> elements that are used to trigger in-page functionality (like collapsing content), rather than linking to new pages or sections within the current page, these links should be given a role="button" to appropriately convey their purpose to assistive technologies such as screen readers.}}
            <button type="button"{{if paginater.has_prev:}} onclick='location.href="{{=URL(vars=dict(page=paginater.prev_page))}}"'{{pass}}
               class="btn btn-secondary btn-sm {{if not paginater.has_prev:}}disabled{{pass}}"><span
                    class="glyphicon glyphicon glyphicon-menu-left"></span></button>
            <button type="button"{{if paginater.has_next:}} onclick='location.href="{{=URL(vars=dict(page=paginater.next_page))}}"'{{pass}}
               class="btn btn-secondary btn-sm {{if not paginater.has_next:}}disabled{{pass}}"><span
                    class="glyphicon glyphicon glyphicon-menu-right"></span></button>
        </div>
        <small class="text-muted pull-right">Page {{=paginater.page}} of {{=paginater.pages}}&nbsp;</small>
        <div class="clearfix"></div> {{#http://jsfiddle.net/b2m38br9/1/}}
    </div>
</div>

<div id="add_referral_modal" class="modal fade" tabindex="-1" role="dialog">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                        aria-hidden="true"><span class="glyphicon glyphicon-remove"></span></span></button>
                <h4 class="modal-title"><span class="glyphicon glyphicon-plus"></span>
                    Add {{=request.function.capitalize()}}</h4>
            </div>
            <div class="modal-body">
            {{form.element('div#submit_record__row').element('div.col-sm-9')['_class']="col-sm-12"}}    {{# https://groups.google.com/forum/#!topic/web2py/bgDJWVmhS5Y}}
            {{for i in form.elements('div.form-group'):}}   {{# just .form-group works, but better to be explicit  # http://www.w3schools.com/bootstrap/bootstrap_forms_sizing.asp}}
                {{i['_class'] += " form-group-sm"}}
            {{pass}}
                {{=form}}
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div><!-- /.modal -->

{{block page_js}}
{{include '__page_js/tooltip.html'}}
{{include '__page_js/flash_modal.html'}}
{{end}}